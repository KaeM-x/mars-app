<mat-card class="weather-card">
  <mat-card-header>
    <mat-card-title>Sol {{ solData?.sol }}</mat-card-title>
    <mat-card-subtitle>
      {{ solData?.First_UTC | date: 'mediumDate' }} – Season: {{ solData?.Season ?? 'unknown' }}
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div class="weather-grid">
      <div>
        <p><strong>Avg Temp:</strong></p>
        <p>{{ solData?.AT?.av ?? 'no data' }} °C</p>
      </div>
      <div>
        <p><strong>Min Temp:</strong></p>
        <p>{{ solData?.AT?.mn ?? 'no data' }} °C</p>
      </div>
      <div>
        <p><strong>Max Temp:</strong></p>
        <p>{{ solData?.AT?.mx ?? 'no data' }} °C</p>
      </div>
      <div>
        <p><strong>Pressure:</strong></p>
        <p>{{ solData?.PRE?.av ?? 'no data' }} Pa</p>
      </div>
      <div>
        <p><strong>Wind Speed:</strong></p>
        <p>{{ solData?.HWS?.av ?? 'no data' }} m/s</p>
      </div>
      <div>
        <p><strong>Wind Dir:</strong></p>
        <p>{{ solData?.WD?.most_common?.compass_point ?? 'no data' }}</p>
      </div>
    </div>
  </mat-card-content>
</mat-card>

<!-- Przyciski -->
<div class="note-actions">
  <button mat-stroked-button color="accent" (click)="showForm = !showForm">
    {{ showForm ? 'Cancel' : 'Add Note' }}
  </button>

  <button mat-stroked-button color="primary" (click)="showNotes = !showNotes">
    {{ showNotes ? 'Hide Notes' : 'Show Notes' }}
  </button>
</div>

<!-- Formularz -->
<form *ngIf="showForm" (ngSubmit)="submitNote()" class="note-form">
  <mat-form-field appearance="fill" class="full-width">
    <mat-label>Your note about Sol {{ solData?.sol }}</mat-label>
    <textarea matInput [(ngModel)]="noteContent" name="note" required></textarea>
  </mat-form-field>
  <button mat-raised-button color="accent" type="submit">Save Note</button>
</form>

<!-- Lista notatek -->
<ng-container *ngIf="notes$ | async as notes">
  <div *ngIf="showNotes">
    <h4>Notes:</h4>
    <ul *ngIf="notes.length > 0; else noNotes">
      <li *ngFor="let note of notes">
        <small>{{ note.createdAt.toDate() | date: 'short' }}</small><br />
        {{ note.content }}
      </li>
    </ul>
    <ng-template #noNotes>
      <p>No notes yet.</p>
    </ng-template>
  </div>
</ng-container>


